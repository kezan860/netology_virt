# Домашнее задание к занятию "5.3. Введение. Экосистема. Архитектура. Жизненный цикл Docker контейнера"

## Задача 1 

Сценарий выполения задачи:

* создайте свой репозиторий на https://hub.docker.com;
* выберете любой образ, который содержит веб-сервер Nginx;
* создайте свой fork образа;
* реализуйте функциональность: запуск веб-сервера в фоне с индекс-страницей, содержащей HTML-код ниже:

```
<html>
<head>
Hey, Netology
</head>
<body>
<h1>I’m DevOps Engineer!</h1>
</body>
</html>
```

Опубликуйте созданный форк в своем репозитории и предоставьте ответ в виде ссылки на https://hub.docker.com/username_repo.

## Ответ:

[Ссылка на образ](https://hub.docker.com/repository/docker/kezan86/mynginx)

## Задача 2 

Посмотрите на сценарий ниже и ответьте на вопрос: "Подходит ли в этом сценарии использование Docker контейнеров или лучше подойдет виртуальная машина, физическая машина? Может быть возможны разные варианты?"

Детально опишите и обоснуйте свой выбор.

Сценарий:

1. Высоконагруженное монолитное java веб-приложение;
2. Nodejs веб-приложение;
3. Мобильное приложение c версиями для Android и iOS;
4. Шина данных на базе Apache Kafka;
5. Elasticsearch кластер для реализации логирования продуктивного веб-приложения - три ноды elasticsearch, два logstash и две ноды kibana;
6. Мониторинг-стек на базе Prometheus и Grafana;
7. MongoDB, как основное хранилище данных для java-приложения;
8. Gitlab сервер для реализации CI/CD процессов и приватный (закрытый) Docker Registry.

## Ответ:

1. Физический сервер, т.к. монолитное, селдовательно в микросерверах не реализуемо 
без изменения кода, и так как высоконагруженное -  то необходим физический 
доступ к ресурсами, без использования гипервизора виртуалки.
2. Это веб приложение, для таких приложений достаточно докера, противопоказаний 
для контейнерной реализации не вижу и в рамках микропроцессрной архитектуры 
может быть хорошим решением. 
3. Виртаулка -  приложение в докере не имеет GUI, а это по описанию не вариант. 
4. Зависит от передаваемых данных или контура (тест/прод), для прода и 
критичности данных лучше Вируалка, для теста достаточно Контейнерной реализации, 
если потеря данных при потере контенйера не является критичной то можно и в 
контейнере. 
5. Сам Elasticsearvh лучше на виртуалку, отказоустойчивость решается на уровне 
кластера, кибану и логсташ можно вынести в докер контейнер, или так же на виртуалках. 
существуют решения и в таком и в таком исполнении - в интернете есть описания 
(ссылки не стал кприкладывать :) ) использование в Докерем может дать "+" для 
использования в тестовом периоде с максимальным функционалом, в докере можно 
перезаливать машину каждый месяц и получать опять полную функциональность
6. Сами системы не хранят как таковых данны, можно развернуть на Докере, 
минусов не вижу, в + скорость развертывания, возможность масштабирования для 
различных задачь: например у графаны есть ограничение на число обрабатываемых 
метрик и может понадобиться разделения под разные задачи (контуры)
7. Можно использовать Виртуальную машину, т.к. хранилище и  не сказано что 
высоконагруженное в Контейнере хранить БД с данными не подходит для физического 
сервера может быть через чур расточительно
8. GitLab можно развернуть на виртуалке, докер не совсем подойдет для этой задачи
из-за высокой нагрузки при выполнении пайплайнов.

## Задача 3 

* Запустите первый контейнер из образа centos c любым тэгом в фоновом режиме, подключив папку /data из текущей рабочей директории на хостовой машине в /data контейнера;
* Запустите второй контейнер из образа debian в фоновом режиме, подключив папку /data из текущей рабочей директории на хостовой машине в /data контейнера;
* Подключитесь к первому контейнеру с помощью docker exec и создайте текстовый файл любого содержания в /data;
* Добавьте еще один файл в папку /data на хостовой машине;
* Подключитесь во второй контейнер и отобразите листинг и содержание файлов в /data контейнера.

## Ответ:

```bash
admsec@ns1:~/docker$ docker run -v /home/admsec/docker/data/:/data -i -d centos bash
d51629218a5b1c7934623cad8eb08f3009b93b45b736781fb7bc520a04410277
admsec@ns1:~/docker$ docker run -v /home/admsec/docker/data/:/data -i -d debian bash
c42f530ed45dc127348e0a68c03c9b154d7c8d66bb7a7d89ad719b3050c9f8c5
admsec@ns1:~/docker$ 
admsec@ns1:~/docker$ 
admsec@ns1:~/docker$ docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED          STATUS          PORTS     NAMES
c42f530ed45d   debian    "bash"    6 seconds ago    Up 5 seconds              eloquent_driscoll
d51629218a5b   centos    "bash"    11 seconds ago   Up 10 seconds             silly_bardeen
admsec@ns1:~/docker$ 
admsec@ns1:~/docker$ 
admsec@ns1:~/docker$ docker exec -it silly_bardeen bash
[root@d51629218a5b /]# touch /data/1.txt
[root@d51629218a5b /]# exit
exit
admsec@ns1:~/docker$ touch data/2.txt
admsec@ns1:~/docker$ 
admsec@ns1:~/docker$ 
admsec@ns1:~/docker$ docker exec -it eloquent_driscoll bash
root@c42f530ed45d:/# 
root@c42f530ed45d:/# 
root@c42f530ed45d:/# ls -l /data/
total 0
-rw-r--r-- 1 root root 0 Nov 11 18:31 1.txt
-rw-rw-r-- 1 1000 1000 0 Nov 11 18:31 2.txt
root@c42f530ed45d:/# 
root@c42f530ed45d:/# 
root@c42f530ed45d:/# 
root@c42f530ed45d:/# exit           
exit
```


## Задача 4 (*)

Воспроизвести практическую часть лекции самостоятельно.

Соберите Docker образ с Ansible, загрузите на Docker Hub и пришлите ссылку вместе с остальными ответами к задачам.

## Ответ:

[Ссылка на образ](https://hub.docker.com/repository/docker/kezan86/dockadns)